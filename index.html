<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>운송 기록부</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif; margin: 0; padding: 1em; background-color: #f5f5f5; }
        .container { max-width: 600px; margin: auto; background-color: white; padding: 1.5em; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h1, h2 { text-align: center; color: #333; }
        h2 { border-bottom: 2px solid #eee; padding-bottom: 0.5em; margin-top: 2.5em; }
        form, fieldset { display: flex; flex-direction: column; gap: 1em; }
        fieldset { border: 1px solid #ddd; border-radius: 4px; padding: 1em; margin-bottom: 1em; }
        legend { font-weight: bold; color: #555; }
        .input-group { display: flex; gap: 0.5em; }
        .input-group > * { flex: 1; }
        input, select, button { padding: 0.8em; font-size: 1em; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #007bff; color: white; font-weight: bold; cursor: pointer; border: none; transition: background-color 0.2s; margin-top: 0.5em; }
        button.setting-save-btn { background-color: #28a745; margin-top: 0;}
        button:hover { opacity: 0.8; }
        
        #start-gps-btn { background-color: #17a2b8; }
        #end-gps-btn { background-color: #ffc107; color: #333; }
        #gps-status { text-align: center; font-size: 0.9em; color: #555; background-color: #e9ecef; padding: 0.5em; border-radius: 4px; margin-top: 0.5em; line-height: 1.5;}

        .view-section { margin-top: 2em; }
        .view-tabs { display: flex; border-bottom: 2px solid #ddd; }
        .tab-btn { background-color: #f1f1f1; color: #555; border: 1px solid #ccc; border-bottom: none; cursor: pointer; padding: 12px 15px; margin-bottom: -2px; border-radius: 6px 6px 0 0; flex: 1; font-size: 1em; font-weight: 500; transition: all 0.2s ease-in-out; }
        .tab-btn:hover:not(.active) { background-color: #e9ecef; }
        .tab-btn.active { color: white; border-bottom: 2px solid white; }
        .tab-btn[data-view="daily"].active { background-color: #28a745; border-color: #28a745; }
        .tab-btn[data-view="monthly"].active { background-color: #007bff; border-color: #007bff; }
        .tab-btn[data-view="yearly"].active { background-color: #17a2b8; border-color: #17a2b8; }
        .view-content { display: none; padding-top: 1em; }
        .view-content.active { display: block; }
        
        .selector-group { display: flex; gap: 1em; justify-content: center; margin-bottom: 1em; }
        .summary, .subsidy-summary, .cumulative-summary { border-radius: 4px; padding: 1em; margin-bottom: 1em; line-height: 1.8; }
        .summary { background-color: #e9f5ff; }
        .subsidy-summary { background-color: #f8f9fa; border: 1px solid #eee; text-align: center; }
        .cumulative-summary { background-color: #fffde7; border: 1px solid #eee; }
        .cumulative-summary strong { font-size: 1.1em; }
        
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 0.8em; text-align: left; }
        th { background-color: #f2f2f2; }
        .responsive-table th, .responsive-table td { border: 1px solid #ddd; }
        .yearly-summary-table th, .yearly-summary-table td { border: 1px solid #ddd; text-align: center;}


        .progress-bar-container { background-color: #e9ecef; border-radius: .25rem; height: 1rem; margin-top: 0.5em; }
        .progress-bar { background-color: #17a2b8; height: 1rem; border-radius: .25rem; text-align: center; color: white; font-size: 0.8em; line-height: 1rem; }

        .note { color: #555; font-size: 0.9em; }
        .note a { color: #0056b3; text-decoration: none; margin-right: 5px; }
        .note a:hover { text-decoration: underline; }
        .income { color: green; font-weight: bold; }
        .cost { color: red; font-weight: bold; }
        .hidden { display: none; }
        .action-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 1em; margin-top: 2em; }
        .action-buttons button { width: 100%; margin: 0; }
        #export-csv-btn { background-color: #28a745; }
        #export-json-btn { background-color: #6c757d; }
        #import-json-btn { background-color: #fd7e14; }
        #clear-btn { background-color: #dc3545; }

        /* <<< 모바일 반응형 테이블 스타일 추가 >>> */
        @media screen and (max-width: 768px) {
            .responsive-table thead {
                display: none;
            }
            .responsive-table, .responsive-table tbody, .responsive-table tr, .responsive-table td {
                display: block;
                width: 100%;
            }
            .responsive-table tr {
                margin-bottom: 1em;
                border: 1px solid #ddd;
                border-radius: 4px;
            }
            .responsive-table td {
                text-align: right;
                padding-left: 50%;
                position: relative;
                border: none;
                border-bottom: 1px solid #eee;
            }
            .responsive-table td:before {
                content: attr(data-label);
                position: absolute;
                left: 0;
                width: 45%;
                padding-left: 1em;
                font-weight: bold;
                text-align: left;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>운송 기록부</h1>
        
        <form id="record-form">
            <!-- 폼 내용은 이전과 동일 -->
        </form>

        <div class="view-section">
            <h2>기록 조회</h2>
            <div class="view-tabs">
                <button class="tab-btn active" data-view="daily">일별</button>
                <button class="tab-btn" data-view="monthly">월별</button>
                <button class="tab-btn" data-view="yearly">연도별</button>
            </div>
            
            <!-- 테이블에 responsive-table 클래스 추가 -->
            <div id="daily-view" class="view-content active">
                <div class="selector-group"><input type="date" id="daily-date-picker"></div>
                <div id="daily-summary" class="summary"></div>
                <table id="daily-records-table" class="responsive-table">
                    <thead><tr><th>시간</th><th>구분</th><th>내용</th><th>수입/지출</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div id="monthly-view" class="view-content">
                <div class="selector-group"><select id="monthly-year-select"></select><select id="monthly-month-select"></select></div>
                <div id="monthly-summary" class="summary"></div>
                <table id="monthly-records-table" class="responsive-table">
                    <thead><tr><th>일시</th><th>구분</th><th>구간 / 내용</th><th>수입/지출</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>

            <div id="yearly-view" class="view-content">
                 <div class="selector-group"><select id="yearly-year-select"></select></div>
                <table id="yearly-summary-table" class="yearly-summary-table">
                    <thead><tr><th>월</th><th>총수입(만원)</th><th>총지출(만원)</th><th>정산(만원)</th><th>운행거리(km)</th><th>주유량(L)</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
        <!-- 이하 내용은 이전과 동일 -->
    </div>

    <script>
        // --- JavaScript 코드는 이전 버전과 100% 동일합니다 ---
        // 이전 답변의 <script> 태그 안의 모든 내용을 여기에 붙여넣으시면 됩니다.

        // <<< 조회 함수 수정 (data-label 속성 추가) >>>
        function displayDailyRecords() {
            // ... (기존 로직) ...
            filteredRecords.forEach(r => {
                // ... (기존 로직) ...
                tr.innerHTML = `
                    <td data-label="시간">${r.time}</td>
                    <td data-label="구분">${r.type === '화물운송' ? '운송' : r.type}</td>
                    <td data-label="내용">${detailsCell}</td>
                    <td data-label="수입/지출">${moneyCell}</td>
                `;
                dailyTbody.appendChild(tr);
            });
            // ... (기존 로직) ...
        }

        function displayMonthlyRecords() {
            // ... (기존 로직) ...
            filteredRecords.forEach(r => {
                // ... (기존 로직) ...
                tr.innerHTML = `
                    <td data-label="일시">${r.date.substring(5)} ${r.time}</td>
                    <td data-label="구분">${r.type === '화물운송' ? '운송' : r.type}</td>
                    <td data-label="구간 / 내용">${detailsCell}</td>
                    <td data-label="수입/지출">${moneyCell}</td>
                `;
                monthlyTbody.appendChild(tr);
            });
            // ... (기존 로직) ...
        }

        // --- 초기화 함수 ---
        // ... (이전과 동일)
    </script>
</body>
</html>
